<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>Creating a New Plugin - jsPsych</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../css/extra.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">jsPsych</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Introduction</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../tutorials/hello-world/">The Basics: Hello World</a>
                        </li>
                    
                        <li >
                            <a href="../../tutorials/go-nogo-task/">Demo Experiment: Simple Reaction Time Task</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Core Library API <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../core_library/overview/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../../core_library/jspsych-core/">jsPsych core</a>
                        </li>
                    
                        <li >
                            <a href="../../core_library/jspsych-data/">jsPsych.data</a>
                        </li>
                    
                        <li >
                            <a href="../../core_library/jspsych-randomization/">jsPsych.randomization</a>
                        </li>
                    
                        <li >
                            <a href="../../core_library/jspsych-turk/">jsPsych.turk</a>
                        </li>
                    
                        <li >
                            <a href="../../core_library/jspsych-pluginAPI/">jsPsych.pluginAPI</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Plugins <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../overview/">Overview</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">Creating a New Plugin</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-animation/">jspsych-animation</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-call-function/">jspsych-call-function</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-categorize/">jspsych-categorize</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-categorize-animation/">jspsych-categorize-animation</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-free-sort/">jspsych-free-sort</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-html/">jspsych-html</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-instructions/">jspsych-instructions</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-multi-stim-multi-response/">jspsych-multi-stim-multi-response</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-palmer/">jspsych-palmer</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-reconstruction/">jspsych-reconstruction</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-same-different/">jspsych-same-different</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-similarity/">jspsych-similarity</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-single-audio/">jspsych-single-audio</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-single-stim/">jspsych-single-stim</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-survey-likert/">jspsych-survey-likert</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-survey-text/">jspsych-survey-text</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-text/">jspsych-text</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-visual-search-circle/">jspsych-visual-search-circle</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-vsl-animate-occlusion/">jspsych-vsl-animate-occlusion</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-vsl-grid-scene/">jspsych-vsl-grid-scene</a>
                        </li>
                    
                        <li >
                            <a href="../jspsych-xab/">jspsych-xab</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Features <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../features/chunks-blocks-trials/">Creating an Experiment: Chunks, Blocks, & Trials</a>
                        </li>
                    
                        <li >
                            <a href="../../features/progress-bar/">Automatic Progress Bar</a>
                        </li>
                    
                        <li >
                            <a href="../../features/mturk/">Integrating with Mechanical Turk</a>
                        </li>
                    
                        <li >
                            <a href="../../features/data/">Data Storage</a>
                        </li>
                    
                        <li >
                            <a href="../../features/randomization-repetition/">Randomization & Repetition</a>
                        </li>
                    
                        <li >
                            <a href="../../features/functions-as-parameters/">Using Functions as Plugin Parameters</a>
                        </li>
                    
                        <li >
                            <a href="../../features/callbacks/">Event-related Callback Functions</a>
                        </li>
                    
                        <li >
                            <a href="../../features/image-preloading/">Image Preloading</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../../support/">Support</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../about/about/">About jsPsych</a>
                        </li>
                    
                        <li >
                            <a href="../../about/license/">License</a>
                        </li>
                    
                        <li >
                            <a href="../../about/contributing/">Contributing to jsPsych</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../overview/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../jspsych-animation/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/jodeleeuw/jsPsych">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#creating-a-new-plugin">Creating a new plugin</a></li>
        
            <li><a href="#whats-in-a-plugin-file">What's in a plugin file?</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="creating-a-new-plugin">Creating a new plugin</h1>
<p>Creating new plugins is the way to add new kinds of tasks to jsPsych. A task can be virtually any kind of activity. If it can be implemented in JavaScript, then it almost certainly can be turned into a plugin.</p>
<h2 id="whats-in-a-plugin-file">What's in a plugin file?</h2>
<p>Plugin files follow a specific template. Adherence to the template is what allows jsPsych to run a plugin without knowing anything about what the plugin is doing. What makes plugins so flexible is that the template imposes very few requirements on the code. Here's what an empty plugin template looks like:</p>
<pre><code>jsPsych['plugin-name'] = (function(){

  var plugin = {};

  plugin.create = function(params){
    var trials = [];

    trials.push({});

    return trials;
  }

  plugin.trial = function(display_element, trial){
    jsPsych.finishTrial();
  }

  return plugin;

})();
</code></pre>

<p>This plugin will work! It defines a plugin called 'plugin-name', and it does absolutely nothing. However, it won't break the experiment, and jsPsych will understand that this is a valid plugin.</p>
<p>Let's examine it in more detail.</p>
<p>The overall structure of the plugin is defined using a module JavaScript design pattern. In this pattern, we use what's called an anonymous closure. This is why the first line has <code>(function(){</code> and the last line is <code>})();</code>. The details aren't important, but if you want to learn more about it, <a href="http://www.adequatelygood.com/JavaScript-Module-Pattern-In-Depth.html">this is a nice overview</a>. The reason this pattern is useful is because it allows for persistent state and private scope. In other words, the plugin is isolated can't be messed up by other plugins.</p>
<p>The module, created by the <code>(function(){</code>  <code>})();</code> expressions, contains an object called <code>plugin</code> that has two properties, <code>create</code> and <code>trial</code>. Both properties define functions. The <code>plugin</code> object is returned at the end of the module, which is what assigns the defined properties of <code>plugin</code> to <code>jsPsych['plugin-name']</code>.</p>
<h4 id="plugincreate">plugin.create</h4>
<p>The <code>create</code> method is used during the initialization of the experiment. The purpose of the create method is to define an array of trial objects. Each trial object contains the parameters necessary for running a trial. A single trial object will be passed into the <code>plugin.trial</code> method as the <code>trial</code> parameter when the trial runs during the experiment. Therefore, any properties of the trial objects in the array can be accessed later on by the trial method while the experiment is running. The <code>params</code> parameter is the object created by an experimenter when they are defining an experiment. For example:</p>
<pre><code class="javascript">var block = {
  type: 'single-stim',
  stimuli: 'imgA.jpg',
  choices: ['A','B']
}

jsPsych.init({ experiment_structure: [block] });
</code></pre>

<p>The variable <code>block</code> will be passed into the <code>create</code> method of the single-stim plugin as the parameter <code>params</code>. The create method is then responsible for construction an array of trials with the appropriate set of parameters to run the trial.</p>
<h4 id="plugintrial">plugin.trial</h4>
<p>The <code>trial</code> method is responsible for running a single trial. There are two parameters that are passed into the trial method. The first, <code>display_element</code>, is the DOM element where jsPsych content is being rendered. The second, <code>trial</code>, is an object containing the parameters defined by the <code>create</code> method.</p>
<p>The only requirement for the <code>trial</code> method is that it calls <code>jsPsych.finishTrial()</code> when it is done. This is how jsPsych knows to advance to the next trial in the experiment (or end the experiment if it is the last trial). The plugin can do whatever it needs to do before that point.</p>
<p>Of course, there are other things that you will probably want the plugin to do besides just end. Here are some examples:</p>
<h5 id="change-the-content-of-the-display">Change the content of the display</h5>
<p>There are a few ways to change the content of the display. The <code>display_element</code> parameter of the trial method contains the jQuery representation of the DOM element for displaying content, so you can use various jQuery methods for manipulating the content. Two common ones are <code>append</code> and <code>html</code>.</p>
<pre><code>display_element.append('&lt;p&gt;This is the first paragraph&lt;/p&gt;');
display_element.append('&lt;p&gt;This is the second paragraph&lt;/p&gt;');
</code></pre>

<p><code>append</code> will <em>add</em> content to the display. The above calls would result in two paragraphs being rendered.</p>
<pre><code>display_element.html('&lt;p&gt;This is the first paragraph&lt;/p&gt;`);
display_element.html('&lt;p&gt;This paragraph will replace the first one&lt;/p&gt;`);
</code></pre>

<p><code>html</code> will <em>replace</em> the content on the display. The above calls will result in only the second paragraph appearing on the screen. It is often appropriate to use the <code>html</code> method to clear the display at the end of a trial:</p>
<pre><code>// clear the display
display_element.html('');
</code></pre>

<h5 id="write-data">Write data</h5>
<p>Plugins exist to collect data, so saving data is obviously a crucial thing to do! There is a method to make this process easy:</p>
<pre><code>jsPsych.data.write({
  correct: true,
  rt: 350
})
</code></pre>

<p>The above function call will record data for the trial. The data recorded will be that <code>correct</code> is <code>true</code> and that <code>rt</code> is <code>350</code>. Additional data for the trial will also be collected automatically by the jsPsych library.</p>
<p>A plugin should only write data <strong>once</strong> per trial. </p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
        <script src="../../js/extra.js"></script>
        <script src="../../js/analytics.js"></script>
    </body>
</html>